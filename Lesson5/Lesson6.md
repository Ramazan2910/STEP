# Ð¢ÐµÐ¼Ñ‹ ÑƒÑ€Ð¾ÐºÐ°: Ð¢Ñ€Ð°Ð½Ð·Ð°ÐºÑ†Ð¸Ð¸ 
- Ð§Ñ‚Ð¾ Ñ‚Ð°ÐºÐ¾Ðµ Ñ‚Ñ€Ð°Ð½Ð·Ð°ÐºÑ†Ð¸Ð¸
- Ð—Ð°Ñ‡ÐµÐ¼ Ð½ÑƒÐ¶Ð½Ñ‹ Ñ‚Ñ€Ð°Ð½Ð·Ð°ÐºÑ†Ð¸Ð¸ 
- ACID
- ÐŸÑ€Ð¸Ð¼ÐµÑ€Ñ‹ Ñ‚Ñ€Ð°Ð½Ð·Ð°ÐºÑ†Ð¸Ð¹
- 
- Ð¿Ð¾Ð´Ð·Ð°Ð¿Ñ€Ð¾ÑÑ‹

## Ð§Ñ‚Ð¾ Ñ‚Ð°ÐºÐ¾Ðµ Ñ‚Ñ€Ð°Ð½Ð·Ð°ÐºÑ†Ð¸Ð¸ ? 

`Ð¢Ñ€Ð°Ð½Ð·Ð°ÐºÑ†Ð¸Ñ` - ÑÑ‚Ð¾ Ð¿Ð¾ÑÐ»ÐµÐ´Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒÐ½Ð¾ÑÑ‚ÑŒ Ð¾Ð¿ÐµÑ€Ð°Ñ†Ð¸Ð¹, ÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ðµ Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÑÑŽÑ‚ÑÑ ÐºÐ°Ðº ÐµÐ´Ð¸Ð½Ð¾Ðµ Ñ†ÐµÐ»Ð¾Ðµ. 
Ð¢Ñ€Ð°Ð½Ð·Ð°ÐºÑ†Ð¸Ð¸ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÑŽÑ‚ÑÑ Ð´Ð»Ñ Ð¾Ð±ÐµÑÐ¿ÐµÑ‡ÐµÐ½Ð¸Ñ Ñ†ÐµÐ»Ð¾ÑÑ‚Ð½Ð¾ÑÑ‚Ð¸ Ð±Ð°Ð·Ñ‹ Ð´Ð°Ð½Ð½Ñ‹Ñ….

Ð¢ÑƒÑ‚ Ð²Ð°Ð¶Ð½Ð¾ Ð¿Ð¾Ð½ÑÑ‚ÑŒ Ñ‡Ñ‚Ð¾ ÑÑ‚Ð¾ Ð¿Ð¾ÑÐ»ÐµÐ´Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒÐ½Ð¾ÑÑ‚ÑŒ Ð¾Ð¿ÐµÑ€Ð°Ñ†Ð¸Ð¹, Ð½Ð°Ð¿Ñ€Ð¸Ð¼ÐµÑ€ Ð¼Ñ‹ Ð¼Ð¾Ð¶ÐµÐ¼ ÑÐ¾Ð·Ð´Ð°Ñ‚ÑŒ Ñ‚Ð°Ð±Ð»Ð¸Ñ†Ñƒ
Ð¸ ÑÑ€Ð°Ð·Ñƒ Ð·Ð°Ð¿Ð¾Ð»Ð½Ð¸Ñ‚ÑŒ ÐµÐ³Ð¾ Ð´Ð°Ð½Ð½Ñ‹Ð¼Ð¸. ÐœÑ‹ Ð¼Ð¾Ð¶ÐµÐ¼ ÑÐ´ÐµÐ»Ð°Ñ‚ÑŒ ÑÑ‚Ð¾ ÐºÐ°Ðº Ð² Ð¾Ð´Ð½Ð¾Ð¹ Ñ‚Ñ€Ð°Ð½Ð·ÐºÐ°Ñ†Ð¸Ð¸ Ñ‚Ð°Ðº Ð¸ Ð² Ð´Ð²ÑƒÑ….

Ð•ÑÐ»Ð¸ Ð²Ð¾ Ð²Ñ€ÐµÐ¼Ñ Ñ‚Ñ€Ð°Ð½Ð·Ð°ÐºÑ†Ð¸Ð¸ Ð¿Ñ€Ð¾Ð¸Ð·Ð¾Ð¹Ð´ÐµÑ‚ Ð¾ÑˆÐ¸Ð±ÐºÐ°, Ñ‚Ð¾ Ð²ÑÐµ Ð¸Ð·Ð¼ÐµÐ½ÐµÐ½Ð¸Ñ Ð¾Ñ‚ÐºÐ°Ñ‚Ñ‹Ð²Ð°ÑŽÑ‚ÑÑ, 
Ð¸ Ð±Ð°Ð·Ð° Ð´Ð°Ð½Ð½Ñ‹Ñ… Ð¾ÑÑ‚Ð°ÐµÑ‚ÑÑ Ð² Ð¿Ñ€ÐµÐ¶Ð½ÐµÐ¼ ÑÐ¾ÑÑ‚Ð¾ÑÐ½Ð¸Ð¸.


## Ð—Ð°Ñ‡ÐµÐ¼ Ð½ÑƒÐ¶Ð½Ñ‹ Ñ‚Ñ€Ð°Ð½Ð·Ð°ÐºÑ†Ð¸Ð¸ ?

Ð¢Ñ€Ð°Ð½Ð·Ð°ÐºÑ†Ð¸Ð¸ Ð½ÑƒÐ¶Ð½Ñ‹ Ð´Ð»Ñ Ð¾Ð±ÐµÑÐ¿ÐµÑ‡ÐµÐ½Ð¸Ñ Ñ†ÐµÐ»Ð¾ÑÑ‚Ð½Ð¾ÑÑ‚Ð¸ Ð´Ð°Ð½Ð½Ñ‹Ñ….

ÐŸÑ€Ð¸ Ð´Ð¾Ð±Ð°Ð²Ð»ÐµÐ½Ð¸Ð¸ Ð´Ð°Ð½Ð½Ñ‹Ñ… Ð² Ð±Ð°Ð·Ñƒ Ð´Ð°Ð½Ð½Ñ‹Ñ…, Ð¼Ñ‹ Ð¼Ð¾Ð¶ÐµÐ¼ ÑÑ‚Ð¾Ð»ÐºÐ½ÑƒÑ‚ÑŒÑÑ Ñ ÑÐ¸Ñ‚ÑƒÐ°Ñ†Ð¸ÐµÐ¹, ÐºÐ¾Ð³Ð´Ð°
Ð²Ð¾ Ð²Ñ€ÐµÐ¼Ñ Ð´Ð¾Ð±Ð°Ð²Ð»ÐµÐ½Ð¸Ñ Ð´Ð°Ð½Ð½Ñ‹Ñ… Ð¿Ñ€Ð¾Ð¸Ð·Ð¾Ð¹Ð´ÐµÑ‚ Ð¾ÑˆÐ¸Ð±ÐºÐ°. ÐÐ°Ð¿Ñ€Ð¸Ð¼ÐµÑ€, Ð¼Ñ‹ Ð´Ð¾Ð±Ð°Ð²Ð»ÑÐµÐ¼ Ð´Ð°Ð½Ð½Ñ‹Ðµ Ð² Ð´Ð²Ðµ Ñ‚Ð°Ð±Ð»Ð¸Ñ†Ñ‹,
Ð¸ Ð²Ð¾ Ð²Ñ€ÐµÐ¼Ñ Ð´Ð¾Ð±Ð°Ð²Ð»ÐµÐ½Ð¸Ñ Ð´Ð°Ð½Ð½Ñ‹Ñ… Ð²Ð¾ Ð²Ñ‚Ð¾Ñ€ÑƒÑŽ Ñ‚Ð°Ð±Ð»Ð¸Ñ†Ñƒ Ð¿Ñ€Ð¾Ð¸Ð·Ð¾Ð¹Ð´ÐµÑ‚ Ð¾ÑˆÐ¸Ð±ÐºÐ°. Ð’ ÑÑ‚Ð¾Ð¼ ÑÐ»ÑƒÑ‡Ð°Ðµ,
Ð´Ð°Ð½Ð½Ñ‹Ðµ Ð² Ð¿ÐµÑ€Ð²Ð¾Ð¹ Ñ‚Ð°Ð±Ð»Ð¸Ñ†Ðµ Ð±ÑƒÐ´ÑƒÑ‚ Ð´Ð¾Ð±Ð°Ð²Ð»ÐµÐ½Ñ‹, Ð° Ð´Ð°Ð½Ð½Ñ‹Ðµ Ð²Ð¾ Ð²Ñ‚Ð¾Ñ€Ð¾Ð¹ Ñ‚Ð°Ð±Ð»Ð¸Ñ†Ðµ Ð½ÐµÑ‚. Ð’ ÑÐ»ÑƒÑ‡Ð°Ðµ ÐµÑÐ»Ð¸ Ð¾Ð½Ð¸ 
Ð´Ð¾Ð»Ð¶Ð½Ñ‹ Ð±Ñ‹Ñ‚ÑŒ ÑÐ²ÑÐ·Ð°Ð½Ñ‹, Ñ‚Ð¾ ÑÑ‚Ð¾ Ð¿Ñ€Ð¸Ð²ÐµÐ´ÐµÑ‚ Ðº Ð¾ÑˆÐ¸Ð±ÐºÐµ.

Ð¢Ñ€Ð°Ð½Ð·Ð°ÐºÑ†Ð¸Ð¸ Ð¿Ð¾Ð·Ð²Ð¾Ð»ÑÑŽÑ‚ Ð¸Ð·Ð±ÐµÐ¶Ð°Ñ‚ÑŒ Ñ‚Ð°ÐºÐ¸Ñ… ÑÐ¸Ñ‚ÑƒÐ°Ñ†Ð¸Ð¹. Ð•ÑÐ»Ð¸ Ð²Ð¾ Ð²Ñ€ÐµÐ¼Ñ Ñ‚Ñ€Ð°Ð½Ð·Ð°ÐºÑ†Ð¸Ð¸ Ð¿Ñ€Ð¾Ð¸Ð·Ð¾Ð¹Ð´ÐµÑ‚ Ð¾ÑˆÐ¸Ð±ÐºÐ°,
Ñ‚Ð¾ Ð²ÑÐµ Ð¸Ð·Ð¼ÐµÐ½ÐµÐ½Ð¸Ñ Ð¾Ñ‚ÐºÐ°Ñ‚Ñ‹Ð²Ð°ÑŽÑ‚ÑÑ, Ð¸ Ð±Ð°Ð·Ð° Ð´Ð°Ð½Ð½Ñ‹Ñ… Ð¾ÑÑ‚Ð°ÐµÑ‚ÑÑ Ð² Ð¿Ñ€ÐµÐ¶Ð½ÐµÐ¼ ÑÐ¾ÑÑ‚Ð¾ÑÐ½Ð¸Ð¸.

## ACID
- Atomicity (ÐÑ‚Ð¾Ð¼Ð°Ñ€Ð½Ð¾ÑÑ‚ÑŒ)
- Consistency (Ð¡Ð¾Ð³Ð»Ð°ÑÐ¾Ð²Ð°Ð½Ð½Ð¾ÑÑ‚ÑŒ)
- Isolation (Ð˜Ð·Ð¾Ð»Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð½Ð¾ÑÑ‚ÑŒ)
- Durability (Ð”Ð¾Ð»Ð³Ð¾Ð²ÐµÑ‡Ð½Ð¾ÑÑ‚ÑŒ)


### Atomicity (ÐÑ‚Ð¾Ð¼Ð°Ñ€Ð½Ð¾ÑÑ‚ÑŒ)
ÐÑ‚Ð¾Ð¼Ð°Ñ€Ð½Ð¾ÑÑ‚ÑŒ Ð³Ð°Ñ€Ð°Ð½Ñ‚Ð¸Ñ€ÑƒÐµÑ‚, Ñ‡Ñ‚Ð¾ Ñ‚Ñ€Ð°Ð½Ð·Ð°ÐºÑ†Ð¸Ñ Ð»Ð¸Ð±Ð¾ Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÑÐµÑ‚ÑÑ Ð¿Ð¾Ð»Ð½Ð¾ÑÑ‚ÑŒÑŽ, Ð»Ð¸Ð±Ð¾ Ð½Ðµ Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÑÐµÑ‚ÑÑ Ð²Ð¾Ð¾Ð±Ñ‰Ðµ.

### Consistency (Ð¡Ð¾Ð³Ð»Ð°ÑÐ¾Ð²Ð°Ð½Ð½Ð¾ÑÑ‚ÑŒ)
Ð¡Ð¾Ð³Ð»Ð°ÑÐ¾Ð²Ð°Ð½Ð½Ð¾ÑÑ‚ÑŒ Ð³Ð°Ñ€Ð°Ð½Ñ‚Ð¸Ñ€ÑƒÐµÑ‚, Ñ‡Ñ‚Ð¾ Ñ‚Ñ€Ð°Ð½Ð·Ð°ÐºÑ†Ð¸Ñ Ð¿ÐµÑ€ÐµÐ²Ð¾Ð´Ð¸Ñ‚ Ð±Ð°Ð·Ñƒ Ð´Ð°Ð½Ð½Ñ‹Ñ… Ð¸Ð· Ð¾Ð´Ð½Ð¾Ð³Ð¾ ÑÐ¾Ð³Ð»Ð°ÑÐ¾Ð²Ð°Ð½Ð½Ð¾Ð³Ð¾ ÑÐ¾ÑÑ‚Ð¾ÑÐ½Ð¸Ñ Ð² Ð´Ñ€ÑƒÐ³Ð¾Ðµ ÑÐ¾Ð³Ð»Ð°ÑÐ¾Ð²Ð°Ð½Ð½Ð¾Ðµ ÑÐ¾ÑÑ‚Ð¾ÑÐ½Ð¸Ðµ. ( Ð•ÑÐ»Ð¸ Ñ‚Ñ€Ð°Ð½Ð·Ð°ÐºÑ†Ð¸Ñ Ð½Ð°Ñ‡Ð°Ð»Ð°ÑÑŒ Ð»Ð¸Ð±Ð¾ 100% Ð´Ð° ÑÐºÐ°Ð¶ÐµÑ‚ Ð¸Ð»Ð¸ Ð½ÐµÑ‚ )

### Isolation (Ð˜Ð·Ð¾Ð»Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð½Ð¾ÑÑ‚ÑŒ)
Ð˜Ð·Ð¾Ð»Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð½Ð¾ÑÑ‚ÑŒ Ð³Ð°Ñ€Ð°Ð½Ñ‚Ð¸Ñ€ÑƒÐµÑ‚, Ñ‡Ñ‚Ð¾ Ñ‚Ñ€Ð°Ð½Ð·Ð°ÐºÑ†Ð¸Ñ Ð½Ðµ Ð²Ð»Ð¸ÑÐµÑ‚ Ð½Ð° Ð´Ñ€ÑƒÐ³Ð¸Ðµ Ñ‚Ñ€Ð°Ð½Ð·Ð°ÐºÑ†Ð¸Ð¸. ( Ðš Ð¿Ñ€Ð¸Ð¼ÐµÑ€Ñ‹ ÐµÑÐ»Ð¸ Ð·Ð°Ð¿ÑƒÑÑ‚Ð¸Ñ‚ÑŒ Ð´Ð²Ðµ Ñ‚Ñ€Ð°Ð½Ð·Ð°ÐºÑ†Ð¸Ð¸ Ð¾Ð´Ð½Ð¾Ð²Ñ€ÐµÐ¼ÐµÐ½Ð½Ð¾ Ð¾Ð½Ð¸ Ð½Ðµ Ð¿Ð¾Ð²Ð»Ð¸ÑÑŽÑ‚ Ð´Ñ€ÑƒÐ³ Ð½Ð° Ð´Ñ€ÑƒÐ³Ð° )

### Durability (Ð”Ð¾Ð»Ð³Ð¾Ð²ÐµÑ‡Ð½Ð¾ÑÑ‚ÑŒ)
Ð”Ð¾Ð»Ð³Ð¾Ð²ÐµÑ‡Ð½Ð¾ÑÑ‚ÑŒ Ð³Ð°Ñ€Ð°Ð½Ñ‚Ð¸Ñ€ÑƒÐµÑ‚, Ñ‡Ñ‚Ð¾ Ð¸Ð·Ð¼ÐµÐ½ÐµÐ½Ð¸Ñ, Ð²Ð½ÐµÑÐµÐ½Ð½Ñ‹Ðµ Ñ‚Ñ€Ð°Ð½Ð·Ð°ÐºÑ†Ð¸ÐµÐ¹, ÑÐ¾Ñ…Ñ€Ð°Ð½ÑÑŽÑ‚ÑÑ Ð´Ð°Ð¶Ðµ Ð² ÑÐ»ÑƒÑ‡Ð°Ðµ ÑÐ±Ð¾Ñ ÑÐ¸ÑÑ‚ÐµÐ¼Ñ‹.


## ÐŸÑ€Ð¸Ð¼ÐµÑ€Ñ‹ Ñ‚Ñ€Ð°Ð½Ð·Ð°ÐºÑ†Ð¸Ð¹

ÐŸÑ€Ð¸Ð¼ÐµÑ€ Ñ‚Ñ€Ð°Ð½Ð·Ð°ÐºÑ†Ð¸Ð¸ Ð½Ð° SQL:

```sql

BEGIN TRANSACTION;

INSERT INTO users (name, email) VALUES ('John Doe', 'john.doe@gmail.com');
INSERT INTO orders (user_id, product_id) VALUES (1, 1);

COMMIT;

```

Ð’ ÑÑ‚Ð¾Ð¼ Ð¿Ñ€Ð¸Ð¼ÐµÑ€Ðµ Ð¼Ñ‹ Ð´Ð¾Ð±Ð°Ð²Ð»ÑÐµÐ¼ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ Ð² Ñ‚Ð°Ð±Ð»Ð¸Ñ†Ñƒ `users` Ð¸ Ð·Ð°ÐºÐ°Ð· Ð² Ñ‚Ð°Ð±Ð»Ð¸Ñ†Ñƒ `orders`.

Ð•ÑÐ»Ð¸ Ð²Ð¾ Ð²Ñ€ÐµÐ¼Ñ Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÐµÐ½Ð¸Ñ Ñ‚Ñ€Ð°Ð½Ð·Ð°ÐºÑ†Ð¸Ð¸ Ð¿Ñ€Ð¾Ð¸Ð·Ð¾Ð¹Ð´ÐµÑ‚ Ð¾ÑˆÐ¸Ð±ÐºÐ°, Ñ‚Ð¾ Ð²ÑÐµ Ð¸Ð·Ð¼ÐµÐ½ÐµÐ½Ð¸Ñ Ð¾Ñ‚ÐºÐ°Ñ‚Ñ‹Ð²Ð°ÑŽÑ‚ÑÑ.

Ð›ÑŽÐ±Ð°Ñ Ñ‚Ñ€Ð°Ð½Ð·Ð°ÐºÑ†Ð¸Ñ Ð½Ð°Ñ‡Ð¸Ð½Ð°ÐµÑ‚ÑÑ ÑÐ¾ ÑÐ»Ð¾Ð²Ð° `BEGIN TRANSACTION`.

`COMMIT` - Ð´Ð»Ñ Ñ‚Ð¾Ð³Ð¾ Ñ‡Ñ‚Ð¾Ð±Ñ‹ Ð¿Ð¾Ð´Ñ‚Ð²ÐµÑ€Ð´Ð¸Ñ‚ÑŒ Ñ‚Ñ€Ð°Ð½Ð·Ð°ÐºÑ†Ð¸ÑŽ. 


Ð¢Ð°ÐºÐ¶Ðµ Ð¼Ñ‹ Ð¼Ð¾Ð¶ÐµÐ¼ Ð´Ð°Ð²Ð°Ñ‚ÑŒ Ð¸Ð¼ Ð¸Ð¼ÐµÐ½Ð° Ð¸ Ð¾Ñ‚ÐºÐ°Ñ‚Ñ‹Ð²Ð°Ñ‚ÑŒ Ð¸Ñ… Ð² ÑÐ»ÑƒÑ‡Ð°Ðµ ÐµÑÐ»Ð¸ Ð½Ð°Ð¼ Ð½Ðµ Ð½ÑƒÐ¶Ð½Ñ‹ ÑÑ‚Ð¸ Ð¸Ð·Ð¼ÐµÐ½ÐµÐ½Ð¸Ñ: 

```sql

BEGIN TRANSACTION my_transaction;

INSERT INTO users (name, email) VALUES ('John Doe', 'profbat018@gmail.com`);

ROLLBACK my_transaction;

```

Ð”Ð°Ð¶Ðµ ÐµÑÐ»Ð¸ Ð²Ñ‹ Ð½Ðµ Ð½Ð°Ð¿Ð¸ÑÐ°Ð»Ð¸ commit, Ð²Ñ‹ ÑƒÐ²Ð¸Ð´Ð¸Ñ‚Ðµ Ñ‡Ñ‚Ð¾ Ð´Ð°Ð½Ð½Ñ‹Ðµ Ð´Ð¾Ð±Ð°Ð²Ð¸Ð»Ð¸ÑÑŒ. 
Ð­Ñ‚Ð¾ Ð¿Ñ€Ð¾Ð¸ÑÑ…Ð¾Ð´Ð¸Ñ‚ Ð´Ð»Ñ Ñ‚Ð¾Ð³Ð¾ Ñ‡Ñ‚Ð¾Ð±Ñ‹ Ð²Ñ‹ Ð¼Ð¾Ð³Ð»Ð¸ Ð²ÑÐµ Ð¿Ñ€Ð¾Ð²ÐµÑ€Ð¸Ñ‚ÑŒ Ð¸ ÐµÑÐ»Ð¸ Ñ‡Ñ‚Ð¾ ÑÐ´ÐµÐ»Ð°Ñ‚ÑŒ 
rollback 

### SAVEPOINT 

Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸Ðµ `SAVEPOINT` Ð´Ð»Ñ Ñ‡Ð°ÑÑ‚Ð¸Ñ‡Ð½Ð¾Ð³Ð¾ Ð¾Ñ‚ÐºÐ°Ñ‚Ð°. Ð•ÑÐ»Ð¸ Ð² Ñ‚Ñ€Ð°Ð½Ð·Ð°ÐºÑ†Ð¸Ð¸ ÐµÑÑ‚ÑŒ Ð½ÐµÑÐºÐ¾Ð»ÑŒÐºÐ¾ ÑˆÐ°Ð³Ð¾Ð², Ð¼Ð¾Ð¶Ð½Ð¾ Ð¾Ñ‚ÐºÐ°Ñ‚Ñ‹Ð²Ð°Ñ‚ÑŒÑÑ Ð½Ðµ Ð¿Ð¾Ð»Ð½Ð¾ÑÑ‚ÑŒÑŽ, Ð° Ð´Ð¾ Ð¾Ð¿Ñ€ÐµÐ´ÐµÐ»Ñ‘Ð½Ð½Ð¾Ð³Ð¾ Ð¼Ð¾Ð¼ÐµÐ½Ñ‚Ð° Ñ Ð¿Ð¾Ð¼Ð¾Ñ‰ÑŒÑŽ `SAVEPOINT`.

```sql
START TRANSACTION;

UPDATE accounts SET balance = balance - 200 WHERE id = 1;
SAVEPOINT after_alice;  -- Ð¡Ð¾Ð·Ð´Ð°Ñ‘Ð¼ Ñ‚Ð¾Ñ‡ÐºÑƒ ÑÐ¾Ñ…Ñ€Ð°Ð½ÐµÐ½Ð¸Ñ

UPDATE accounts SET balance = balance + 200 WHERE id = 2;

-- Ð’Ð½ÐµÐ·Ð°Ð¿Ð½Ð¾ Ð¾Ð±Ð½Ð°Ñ€ÑƒÐ¶Ð¸Ð»Ð¸ Ð¾ÑˆÐ¸Ð±ÐºÑƒ! ÐžÑ‚ÐºÐ°Ñ‚Ñ‹Ð²Ð°ÐµÐ¼ÑÑ Ñ‚Ð¾Ð»ÑŒÐºÐ¾ Ð´Ð¾ SAVEPOINT:
ROLLBACK TO SAVEPOINT after_alice;

-- Ð¢ÐµÐ¿ÐµÑ€ÑŒ Ð±Ð°Ð»Ð°Ð½Ñ Bob Ð½Ðµ Ð¸Ð·Ð¼ÐµÐ½Ð¸Ð»ÑÑ, Ð½Ð¾ Ñƒ Alice Ð²ÑÑ‘ ÐµÑ‰Ñ‘ -200

-- Ð•ÑÐ»Ð¸ Ð²ÑÑ‘ Ð½Ð¾Ñ€Ð¼Ð°Ð»ÑŒÐ½Ð¾, Ñ„Ð¸ÐºÑÐ¸Ñ€ÑƒÐµÐ¼ Ð¸Ð·Ð¼ÐµÐ½ÐµÐ½Ð¸Ñ:
COMMIT;
```

ðŸ“Œ ROLLBACK TO SAVEPOINT after_alice; Ð¾Ñ‚ÐºÐ°Ñ‚Ð¸Ñ‚ Ñ‚Ð¾Ð»ÑŒÐºÐ¾ Ð¿Ð¾ÑÐ»ÐµÐ´Ð½ÑŽÑŽ Ð¾Ð¿ÐµÑ€Ð°Ñ†Ð¸ÑŽ (Ð¿ÐµÑ€ÐµÐ²Ð¾Ð´ Bob), Ð½Ð¾ Ð¾ÑÑ‚Ð°Ð²Ð¸Ñ‚ Ð¸Ð·Ð¼ÐµÐ½ÐµÐ½Ð¸Ðµ Ð±Ð°Ð»Ð°Ð½ÑÐ° Alice.

## ÐŸÐ¾Ð´Ð·Ð°Ð¿Ñ€Ð¾ÑÑ‹


```sql
alter table Teacher
add SubjectId int foreign key references Subject(Id)


select p.Name, s.SubjectName, s.Id, AVG(sp.Point) as AvgPoint from dbo.Student
inner join dbo.StudentPoint SP on dbo.Student.Id = SP.StudentId
inner join dbo.Subject S on S.Id = SP.SubjectId
 join dbo.People P on P.Id = Student.PersonId
where SP.Point >= (select AVG(Point) from StudentPoint)
group by p.Name, s.SubjectName, s.Id




select * from Teacher

update Teacher
set Teacher.SubjectId = (
select Id from Subject
    where Subject.SubjectName = Teacher.Subject
    )
where Teacher.SubjectId is null
```











